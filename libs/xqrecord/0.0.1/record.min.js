/**
 * author: gitguanqi
 * version: 0.0.1
 * date: 2021-12-2
 * name: record audio and video
 */
async function createMedia(e,t){try{stream=await navigator.mediaDevices.getUserMedia(t),media=document.querySelector(e),"video"===e&&(media.srcObject=stream),console.log(e,stream);let a={audioBitsPerSecond:128e3,videoBitsPerSecond:25e5};mediaRecorder=new MediaRecorder(stream,a),mediaRecorder.ondataavailable=function(e){chunks.push(e.data)},mediaRecorder.start(),mediaRecorder.onstop=function(){let t=new Blob(chunks,{type:mediaRecorder.mimeType}),a=window.URL.createObjectURL(t);"video"===e&&(media.srcObject=null),media.src=a,stopSet(e)}}catch(e){console.log("getUserMediaï¼š ",e)}}function start(e){let t="audio"==e?{audio:!0}:{video:!0};createMedia(e,t)}function stop(e){mediaRecorder.stop()}function stopSet(e){"audio"==e?(stream.getAudioTracks()[0].stop(),stream=null):stream.getVideoTracks()[0].stop(),stream=null,mediaRecorder=null,chunks=[],meida=null}